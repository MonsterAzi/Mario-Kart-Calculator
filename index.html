<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mario Kart World - Combo Calculator</title>
    
    <!-- Google Font: Lexend -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- Global Styles & Theme --- */
        :root {
            --page-bg: #2c3e50;
            --panel-bg: #ffffff;
            --header-bg: #4d4d4d; /* CHANGED */
            --header-arrows-dark: #3a3a3a; /* CHANGED */
            --text-dark: #212529;
            --text-light: #ecf0f1;
            --accent-gold: #f1c40f;
            --button-bg: #00a8e8;
            --fieldset-bg: #f8f9fa;
        }

        body {
            font-family: 'Lexend', sans-serif;
            line-height: 1.6;
            background-color: var(--page-bg);
            color: var(--text-light);
            margin: 0;
            padding: 20px;
        }

        main {
            max-width: 1200px;
            margin: 20px auto;
        }

        h1 {
            font-size: 2.5em;
            color: var(--accent-gold);
            text-align: center;
            font-weight: 700;
            text-shadow: 0 0 8px rgba(241, 196, 15, 0.3);
            margin-bottom: 10px;
        }
        
        p.subtitle {
            text-align: center;
            color: #bdc3c7;
            max-width: 800px;
            margin: 0 auto 40px auto;
        }

        /* --- Panel & Layout Styles --- */
        .panel {
            background-image: linear-gradient(
                transparent 50px, /* Transparent for the top 50px */
                var(--panel-bg) 50px  /* Solid white for the rest */
            );
            
            color: var(--text-dark);
            border-radius: 48px;
            margin-bottom: 40px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .panel-header {
            /* RESTORE its own background properties */
            background-color: var(--header-bg);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='25' height='60' viewBox='0 0 25 60'%3E%3Cpolyline points='8,8 12,8 18,20 12,32 8,32 14,20 8,8' stroke='none' fill='%233a3a3a'/%3E%3C/svg%3E");
            background-repeat: repeat-x;
            background-position: center;
        
            /* These are still good practice */
            padding: 15px 25px;
            border-top-left-radius: inherit;
            border-top-right-radius: inherit;
        }

        .panel-header h2 {
            color: var(--accent-gold);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            font-size: 1.8em;
            margin: 0;
            text-align: center;
        }
        
        .panel-content {
            padding: 30px 40px;
        }

        /* --- Controls & Form Elements --- */
        #controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        fieldset {
            background: var(--fieldset-bg);
            border: 1px solid #dee2e6;
            border-radius: 12px;
            padding: 20px;
        }

        legend {
            font-weight: 700;
            font-size: 1.1em;
            color: var(--text-dark);
            padding: 0 10px;
            margin-left: 5px;
            margin-bottom: 15px;
        }

        .input-group {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .input-group label {
            flex: 1;
            min-width: 140px;
        }

        .input-group input {
            font-family: 'Lexend', sans-serif;
            width: 70px;
            padding: 8px;
            background-color: #fff;
            border: 1px solid #ced4da;
            color: var(--text-dark);
            border-radius: 8px;
            text-align: right;
            font-size: 1em;
        }

        .input-group span {
            margin-left: 8px;
        }

        #calculate-btn {
            width: 100%;
            padding: 14px 20px;
            font-size: 1.3em;
            font-weight: 700;
            font-family: 'Lexend', sans-serif;
            color: #fff;
            background-color: var(--button-bg);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        #calculate-btn:hover {
            background-color: #0093d1;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 168, 232, 0.3);
        }

        .validation-message {
            color: #e74c3c;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
            display: none;
        }

        /* --- Results Table --- */
        #results-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #dee2e6;
            padding: 12px 15px;
            text-align: center;
            vertical-align: middle;
        }

        th {
            background-color: #dee2e6;
            color: var(--text-dark);
            font-weight: 700;
            white-space: pre;
        }
        
        tbody tr:first-child td {
            border-top: none;
        }

        tbody tr:nth-child(even) {
            background-color: var(--fieldset-bg);
        }

        tbody tr:hover {
            background-color: #e2f4fb;
        }

        .score-col {
            font-weight: bold;
            font-size: 1.1em;
            background-color: #fff9e6;
            color: #b38600;
        }

        .char-col, .kart-col {
             white-space: pre-wrap;
             text-align: left;
             min-width: 150px;
        }
    </style>
</head>
<body>
    <main>
        <h1>Mario Kart World Combo Calculator</h1>
        <p class="subtitle">Set the percentage weights for each stat to find the best character and kart combinations. Main stats and sub-stats must each add up to 100%. The total score is calculated based on your preferences.</p>

        <div class="panel">
            <div class="panel-header">
                <h2>Controls</h2>
            </div>
            <div class="panel-content">
                <div id="controls-grid">
                    <fieldset>
                        <legend>Main Stat Weights</legend>
                        <div class="input-group">
                            <label for="weight-speed">Speed</label>
                            <input type="number" id="weight-speed" value="30" min="0" max="100"><span>%</span>
                        </div>
                        <div class="input-group">
                            <label for="weight-accel">Accel & Mini-Turbo</label>
                            <input type="number" id="weight-accel" value="30" min="0" max="100"><span>%</span>
                        </div>
                        <div class="input-group">
                            <label for="weight-weight">Weight & Coins</label>
                            <input type="number" id="weight-weight" value="10" min="0" max="100"><span>%</span>
                        </div>
                        <div class="input-group">
                            <label for="weight-handling">Handling</label>
                            <input type="number" id="weight-handling" value="30" min="0" max="100"><span>%</span>
                        </div>
                        <div id="main-validation" class="validation-message"></div>
                    </fieldset>

                    <fieldset>
                        <legend>Speed Sub-Stat Weights</legend>
                        <div class="input-group">
                            <label for="sub-solid-speed">Solid Speed</label>
                            <input type="number" id="sub-solid-speed" value="50" min="0" max="100"><span>%</span>
                        </div>
                        <div class="input-group">
                            <label for="sub-coarse-speed">Coarse Speed</label>
                            <input type="number" id="sub-coarse-speed" value="30" min="0" max="100"><span>%</span>
                        </div>
                        <div class="input-group">
                            <label for="sub-liquid-speed">Liquid Speed</label>
                            <input type="number" id="sub-liquid-speed" value="20" min="0" max="100"><span>%</span>
                        </div>
                        <div id="speed-validation" class="validation-message"></div>
                    </fieldset>

                    <fieldset>
                        <legend>Handling Sub-Stat Weights</legend>
                        <div class="input-group">
                            <label for="sub-solid-handling">Solid Handling</label>
                            <input type="number" id="sub-solid-handling" value="50" min="0" max="100"><span>%</span>
                        </div>
                        <div class="input-group">
                            <label for="sub-coarse-handling">Coarse Handling</label>
                            <input type="number" id="sub-coarse-handling" value="30" min="0" max="100"><span>%</span>
                        </div>
                        <div class="input-group">
                            <label for="sub-liquid-handling">Liquid Handling</label>
                            <input type="number" id="sub-liquid-handling" value="20" min="0" max="100"><span>%</span>
                        </div>
                        <div id="handling-validation" class="validation-message"></div>
                    </fieldset>
                </div>
                <button id="calculate-btn">Find Best Combos</button>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header">
                <h2>Results</h2>
            </div>
            <div class="panel-content" style="padding: 0;">
                <div id="results-container">
                    <div id="results-table">
                        <p style="text-align:center; padding: 20px;">Adjust the weights above and click the button to see the results.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- DATA (Unchanged) ---
        const characterData = [
            { name: "Baby Peach\nBaby Daisy\nSwooper\nPara-Biddybud", solidSpeed: 0, coarseSpeed: 0, liquidSpeed: 0, accel: 7, weight: 0, solidHandling: 6, coarseHandling: 6, liquidHandling: 6 },
            { name: "Baby Mario\nGoomba\nSpike", solidSpeed: 1, coarseSpeed: 0, liquidSpeed: 0, accel: 6, weight: 1, solidHandling: 7, coarseHandling: 5, liquidHandling: 5 },
            { name: "Baby Luigi\nDry Bones\nPeepa", solidSpeed: 0, coarseSpeed: 1, liquidSpeed: 0, accel: 6, weight: 1, solidHandling: 5, coarseHandling: 7, liquidHandling: 5 },
            { name: "Baby Rosalina\nSidestepper\nFishbone", solidSpeed: 0, coarseSpeed: 0, liquidSpeed: 1, accel: 6, weight: 1, solidHandling: 5, coarseHandling: 5, liquidHandling: 7 },
            { name: "Toadette\nNabbit", solidSpeed: 2, coarseSpeed: 1, liquidSpeed: 1, accel: 5, weight: 2, solidHandling: 6, coarseHandling: 4, liquidHandling: 4 },
            { name: "Toad\nShy Guy\nStingby", solidSpeed: 1, coarseSpeed: 2, liquidSpeed: 1, accel: 5, weight: 2, solidHandling: 4, coarseHandling: 6, liquidHandling: 4 },
            { name: "Koopa Troopa\nLakitu\nCheep Cheep", solidSpeed: 1, coarseSpeed: 1, liquidSpeed: 2, accel: 5, weight: 2, solidHandling: 4, coarseHandling: 4, liquidHandling: 6 },
            { name: "Peach\nDaisy\nCoin Coffer", solidSpeed: 3, coarseSpeed: 2, liquidSpeed: 2, accel: 4, weight: 3, solidHandling: 5, coarseHandling: 3, liquidHandling: 3 },
            { name: "Yoshi\nMonty Mole", solidSpeed: 2, coarseSpeed: 3, liquidSpeed: 2, accel: 4, weight: 3, solidHandling: 3, coarseHandling: 5, liquidHandling: 3 },
            { name: "Bowser Jr.\nDolphin", solidSpeed: 2, coarseSpeed: 2, liquidSpeed: 3, accel: 4, weight: 3, solidHandling: 3, coarseHandling: 3, liquidHandling: 5 },
            { name: "Mario\nRocky Wrench", solidSpeed: 4, coarseSpeed: 3, liquidSpeed: 3, accel: 3, weight: 4, solidHandling: 4, coarseHandling: 2, liquidHandling: 2 },
            { name: "Luigi\nHammer Bro\nPokey", solidSpeed: 3, coarseSpeed: 4, liquidSpeed: 3, accel: 3, weight: 4, solidHandling: 2, coarseHandling: 4, liquidHandling: 2 },
            { name: "Birdo\nPenguin", solidSpeed: 3, coarseSpeed: 3, liquidSpeed: 4, accel: 3, weight: 4, solidHandling: 2, coarseHandling: 2, liquidHandling: 4 },
            { name: "Pauline\nSnowman\nPiranha Plant", solidSpeed: 5, coarseSpeed: 4, liquidSpeed: 4, accel: 2, weight: 5, solidHandling: 3, coarseHandling: 1, liquidHandling: 1 },
            { name: "King Boo\nConkdor", solidSpeed: 4, coarseSpeed: 5, liquidSpeed: 4, accel: 2, weight: 5, solidHandling: 1, coarseHandling: 3, liquidHandling: 1 },
            { name: "Rosalina\nCataquack", solidSpeed: 4, coarseSpeed: 4, liquidSpeed: 5, accel: 2, weight: 5, solidHandling: 1, coarseHandling: 1, liquidHandling: 3 },
            { name: "Wario\nWiggler", solidSpeed: 6, coarseSpeed: 5, liquidSpeed: 5, accel: 1, weight: 6, solidHandling: 2, coarseHandling: 0, liquidHandling: 0 },
            { name: "Cow\nDonkey Kong\nChargin' Chuck", solidSpeed: 5, coarseSpeed: 6, liquidSpeed: 5, accel: 1, weight: 6, solidHandling: 0, coarseHandling: 2, liquidHandling: 0 },
            { name: "Waluigi\nPianta", solidSpeed: 5, coarseSpeed: 5, liquidSpeed: 6, accel: 1, weight: 6, solidHandling: 0, coarseHandling: 0, liquidHandling: 2 },
            { name: "Bowser", solidSpeed: 6, coarseSpeed: 6, liquidSpeed: 6, accel: 0, weight: 7, solidHandling: 0, coarseHandling: 0, liquidHandling: 0 }
        ];

        const kartData = [
            { name: "Mach Rocket\nR.O.B. H.O.G.", solidSpeed: 6, coarseSpeed: 1, liquidSpeed: 1, accel: 7, weight: 0, solidHandling: 10, coarseHandling: 6, liquidHandling: 6 },
            { name: "Rally Bike\nHyper Pipe", solidSpeed: 0, coarseSpeed: 5, liquidSpeed: 0, accel: 8, weight: 0, solidHandling: 0, coarseHandling: 10, liquidHandling: 6 },
            { name: "Fin Twin\nDolphin Dasher", solidSpeed: 0, coarseSpeed: 0, liquidSpeed: 5, accel: 8, weight: 0, solidHandling: 6, coarseHandling: 6, liquidHandling: 10 },
            { name: "Baby Blooper", solidSpeed: 7, coarseSpeed: 2, liquidSpeed: 2, accel: 6, weight: 1, solidHandling: 9, coarseHandling: 5, liquidHandling: 5 },
            { name: "Biddybuggy (Buggybud)", solidSpeed: 1, coarseSpeed: 6, liquidSpeed: 1, accel: 7, weight: null, solidHandling: 5, coarseHandling: 9, liquidHandling: 5 },
            { name: "Roadster Royale\nB-Dasher\nHot Rod\nBumble V", solidSpeed: 8, coarseSpeed: 4, liquidSpeed: 4, accel: 4, weight: 3, solidHandling: 8, coarseHandling: 3, liquidHandling: 3 },
            { name: "Zoom Buggy\nRally Kart", solidSpeed: 4, coarseSpeed: 8, liquidSpeed: 4, accel: 4, weight: 3, solidHandling: 3, coarseHandling: 8, liquidHandling: 3 },
            { name: "Cloud 9\nRibbit Revster\nCarpet Flyer", solidSpeed: 4, coarseSpeed: 4, liquidSpeed: 8, accel: 4, weight: 3, solidHandling: 3, coarseHandling: 3, liquidHandling: 8 },
            { name: "Billdozer\nBig Horn", solidSpeed: 9, coarseSpeed: 6, liquidSpeed: 6, accel: 2, weight: 5, solidHandling: 7, coarseHandling: 1, liquidHandling: 1 },
            { name: "Bowser Bruiser\nLi'l Dumpy\nTiny Titan (Rally Romper)\nChargin Truck", solidSpeed: 7, coarseSpeed: 10, liquidSpeed: 7, accel: 1, weight: 5, solidHandling: 1, coarseHandling: 7, liquidHandling: 1 },
            { name: "Mecha Trike", solidSpeed: 7, coarseSpeed: 7, liquidSpeed: 10, accel: 1, weight: 5, solidHandling: 1, coarseHandling: 1, liquidHandling: 7 },
            { name: "Rallygator", solidSpeed: 9, coarseSpeed: 6, liquidSpeed: 6, accel: 3, weight: 6, solidHandling: 5, coarseHandling: 0, liquidHandling: 0 },
            { name: "Lobster Roller", solidSpeed: 7, coarseSpeed: 7, liquidSpeed: 10, accel: 2, weight: 6, solidHandling: 0, coarseHandling: 0, liquidHandling: 5 },
            { name: "Standard Bike\nCute Scoot\nTune Thumper", solidSpeed: 1, coarseSpeed: 1, liquidSpeed: 1, accel: 9, weight: 0, solidHandling: 7, coarseHandling: 7, liquidHandling: 7 },
            { name: "Pipe Frame", solidSpeed: 2, coarseSpeed: 2, liquidSpeed: 2, accel: 8, weight: 1, solidHandling: 6, coarseHandling: 6, liquidHandling: 6 },
            { name: "Loco Moto", solidSpeed: 4, coarseSpeed: 4, liquidSpeed: 4, accel: 6, weight: 1, solidHandling: 6, coarseHandling: 6, liquidHandling: 6 },
            { name: "Blastronaut III", solidSpeed: 5, coarseSpeed: 5, liquidSpeed: 5, accel: 6, weight: 3, solidHandling: 3, coarseHandling: 3, liquidHandling: 3 },
            { name: "Standard Kart\nPlushbuggy", solidSpeed: 5, coarseSpeed: 5, liquidSpeed: 5, accel: 5, weight: 2, solidHandling: 5, coarseHandling: 5, liquidHandling: 5 },
            { name: "W-Twin Chopper", solidSpeed: 7, coarseSpeed: 7, liquidSpeed: 7, accel: 3, weight: 2, solidHandling: 5, coarseHandling: 5, liquidHandling: 5 },
            { name: "Reel Racer", solidSpeed: 8, coarseSpeed: 8, liquidSpeed: 8, accel: 2, weight: 3, solidHandling: 4, coarseHandling: 4, liquidHandling: 4 },
            { name: "Junkyard Hog", solidSpeed: 8, coarseSpeed: 8, liquidSpeed: 8, accel: 3, weight: 4, solidHandling: 2, coarseHandling: 2, liquidHandling: 2 },
            { name: "Funky Dorrie", solidSpeed: 4, coarseSpeed: 4, liquidSpeed: 8, accel: 5, weight: 5, solidHandling: 1, coarseHandling: 1, liquidHandling: 6 },
            { name: "Dread Sled", solidSpeed: 3, coarseSpeed: 9, liquidSpeed: 5, accel: 3, weight: 3, solidHandling: 3, coarseHandling: 9, liquidHandling: 4 },
            { name: "Stellar Sled", solidSpeed: 6, coarseSpeed: 8, liquidSpeed: 11, accel: 0, weight: 5, solidHandling: 1, coarseHandling: 2, liquidHandling: 8 }
        ];

        // --- SCRIPT LOGIC (Unchanged, except for table generation) ---
        const calculateBtn = document.getElementById('calculate-btn');
        const resultsTableDiv = document.getElementById('results-table');
        
        calculateBtn.addEventListener('click', calculateAndDisplayCombos);

        function getInputValue(id) {
            return parseFloat(document.getElementById(id).value) || 0;
        }

        function validateWeights(ids, validationDivId) {
            const sum = ids.reduce((total, id) => total + getInputValue(id), 0);
            const validationDiv = document.getElementById(validationDivId);
            if (Math.abs(sum - 100) > 0.1) {
                validationDiv.textContent = `Error: Weights must add up to 100%. Current sum is ${sum.toFixed(1)}%.`;
                validationDiv.style.display = 'block';
                return false;
            }
            validationDiv.style.display = 'none';
            return true;
        }

        function calculateAndDisplayCombos() {
            const isMainValid = validateWeights(['weight-speed', 'weight-accel', 'weight-weight', 'weight-handling'], 'main-validation');
            const isSpeedValid = validateWeights(['sub-solid-speed', 'sub-coarse-speed', 'sub-liquid-speed'], 'speed-validation');
            const isHandlingValid = validateWeights(['sub-solid-handling', 'sub-coarse-handling', 'sub-liquid-handling'], 'handling-validation');

            if (!isMainValid || !isSpeedValid || !isHandlingValid) {
                resultsTableDiv.innerHTML = `<p style="color: #e74c3c; text-align: center; padding: 20px;">Please fix the errors in the weight percentages above.</p>`;
                return;
            }
            
            const weights = {
                speed: getInputValue('weight-speed') / 100,
                accel: getInputValue('weight-accel') / 100,
                weight: getInputValue('weight-weight') / 100,
                handling: getInputValue('weight-handling') / 100,
                subSolidSpeed: getInputValue('sub-solid-speed') / 100,
                subCoarseSpeed: getInputValue('sub-coarse-speed') / 100,
                subLiquidSpeed: getInputValue('sub-liquid-speed') / 100,
                subSolidHandling: getInputValue('sub-solid-handling') / 100,
                subCoarseHandling: getInputValue('sub-coarse-handling') / 100,
                subLiquidHandling: getInputValue('sub-liquid-handling') / 100,
            };

            const allCombos = [];
            for (const char of characterData) {
                for (const kart of kartData) {
                    const combo = {
                        charName: char.name,
                        kartName: kart.name,
                        solidSpeed: char.solidSpeed + kart.solidSpeed,
                        coarseSpeed: char.coarseSpeed + kart.coarseSpeed,
                        liquidSpeed: char.liquidSpeed + kart.liquidSpeed,
                        accel: char.accel + (kart.accel || 0),
                        weight: char.weight + (kart.weight || 0),
                        solidHandling: char.solidHandling + kart.solidHandling,
                        coarseHandling: char.coarseHandling + kart.coarseHandling,
                        liquidHandling: char.liquidHandling + kart.liquidHandling,
                    };

                    const speedScore = (combo.solidSpeed * weights.subSolidSpeed) + (combo.coarseSpeed * weights.subCoarseSpeed) + (combo.liquidSpeed * weights.subLiquidSpeed);
                    const handlingScore = (combo.solidHandling * weights.subSolidHandling) + (combo.coarseHandling * weights.subCoarseHandling) + (combo.liquidHandling * weights.subLiquidHandling);
                    combo.totalScore = (speedScore * weights.speed) + (handlingScore * weights.handling) + (combo.accel * weights.accel) + (combo.weight * weights.weight);
                    allCombos.push(combo);
                }
            }

            allCombos.sort((a, b) => b.totalScore - a.totalScore);

            // --- Updated Table Generation ---
            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th class="char-col">Character</th>
                            <th class="kart-col">Vehicle</th>
                            <th>Solid<br>Speed</th>
                            <th>Coarse<br>Speed</th>
                            <th>Liquid<br>Speed</th>
                            <th>Accel &<br>Mini-Turbo</th>
                            <th>Weight &<br>Coins</th>
                            <th>Solid<br>Handling</th>
                            <th>Coarse<br>Handling</th>
                            <th>Liquid<br>Handling</th>
                            <th class="score-col">Overall<br>Score</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            allCombos.forEach((combo, index) => {
                tableHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td class="char-col">${combo.charName}</td>
                        <td class="kart-col">${combo.kartName}</td>
                        <td>${combo.solidSpeed}</td>
                        <td>${combo.coarseSpeed}</td>
                        <td>${combo.liquidSpeed}</td>
                        <td>${combo.accel}</td>
                        <td>${combo.weight}</td>
                        <td>${combo.solidHandling}</td>
                        <td>${combo.coarseHandling}</td>
                        <td>${combo.liquidHandling}</td>
                        <td class="score-col">${combo.totalScore.toFixed(2)}</td>
                    </tr>
                `;
            });

            tableHTML += `</tbody></table>`;
            resultsTableDiv.innerHTML = tableHTML;
        }

        document.addEventListener('DOMContentLoaded', calculateAndDisplayCombos);
    </script>
</body>
</html>
